class FeaturedVideoSection extends HTMLElement{constructor(){super()}connectedCallback(){this.api=this.getAttribute("data-api"),this.play_button=this.querySelector(".featured-video--play"),this.id=this.getAttribute("data-id"),this.thumbnail="true"===this.getAttribute("data-thumbnail"),this.video_id=this.getAttribute("data-video-id"),this.video_wrapper=this.querySelector(".featured-video--wrapper"),this.thumbnail?this.playButtonListeners():this.loadLibraries()}loadLibraries(){switch(this.api){case"youtube":window.on("theme:youtube:apiReady",()=>this.insertYoutubePlayer()),"loaded"===theme.scripts.youtube?this.insertYoutubePlayer():theme.utils.libraryLoader("youtube","https://"+theme.libraries.youtube,window.onYouTubeIframeAPIReady);break;case"vimeo":theme.utils.libraryLoader("vimeo","https://"+theme.libraries.vimeo,()=>this.insertVimeoPlayer());break;case"plyr":theme.utils.stylesheetLoader("plyr",theme.libraries.plyr+".css"),theme.utils.libraryLoader("plyr",theme.libraries.plyr+".en.js",()=>{this.insertPlyrPlayer()})}}insertVimeoPlayer(){void 0!==Vimeo.Player&&(this.vimeo=new Vimeo.Player("player-"+this.id,{id:this.video_id,autopause:0,playsinline:this.thumbnail?0:1,muted:this.thumbnail?0:1,background:this.thumbnail?0:1,loop:this.thumbnail?0:1,title:0}),this.vimeo.ready().then(()=>{this.showPlayer(),this.thumbnail&&this.vimeoEvents()}),Promise.all([this.vimeo.getVideoWidth(),this.vimeo.getVideoHeight()]).then(([e,t])=>this.setAspectRatio(t,e)),this.vimeo.play())}vimeoEvents(){this.vimeo.getDuration().then(e=>{this.vimeo.addCuePoint(e-.3,{})}),this.vimeo.on("cuepoint",()=>{this.vimeo.setCurrentTime(0),this.vimeo.pause()})}insertYoutubePlayer(){var e,t;void 0!==YT.Player&&({height:e,width:t}=new YT.Player("player-"+this.id,{videoId:this.video_id,playerVars:{enablejsapi:1,host:"https://www.youtube.com",origin:location.origin},events:{onReady:({target:e})=>this.youtubeReady(e),onStateChange:e=>this.youtubeEvents(e)}}).getIframe(),this.setAspectRatio(e,t))}youtubeReady(e){this.thumbnail||e.mute(),this.showPlayer(),e.playVideo()}youtubeEvents({target:e,data:t}){this.thumbnail&&0===t?(e.seekTo(0),e.pauseVideo()):this.thumbnail||0!==t||e.playVideo()}insertPlyrPlayer(){var e;void 0!==Shopify.Video&&!1!==this.thumbnail&&((e=this.video_wrapper.querySelector("video")).on("ready",()=>this.showPlayer()),new Shopify.Video(e,{autoplay:!0,hideControls:!0,muted:!1,loop:{active:!1},controls:["play","progress","current-time","mute","volume","captions","settings","pip","airplay","fullscreen"]}))}showPlayer(){setTimeout(()=>this.video_wrapper.setAttribute("data-transition-active",!0),50)}setAspectRatio(e,t){this.video_wrapper.style.setProperty("--natural-aspect-ratio",t/e)}playButtonListeners(){this.play_button.on("click keydown",e=>{"keydown"===e.type&&"Enter"!==e.key||(e.preventDefault(),this.loadLibraries(),setTimeout(()=>this.setAttribute("data-loaded",!0),400))}),this.play_button.on("mousedown touchstart",()=>this.play_button.dataset.state="pressed"),window.on("mouseup touchend",()=>this.play_button.dataset.state="released",{passive:!0})}}const featuredVideoEl=customElements.get("featured-video");featuredVideoEl||customElements.define("featured-video",FeaturedVideoSection);